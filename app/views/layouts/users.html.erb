<!DOCTYPE html>
<html>
  <head>
    <title>Nutriti</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>

    <script src="https://kit.fontawesome.com/e5ab504795.js" crossorigin="anonymous"></script>
    

  </head>

  <body>
    <div class="container-fluid">
	  <div class="row">
		  <div class="col-md-12" id="content">

    <nav class="navbar navbar-expand-lg navbar-white bg-white">
      <%= link_to image_tag("logo_nutriti.svg", height: 50), week_path(current_user.id), class:"navbar-brand ml-5" %>
      <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
        <% unless current_page?(root_path) || current_page?(week_path) %>          
          <h5 class="ml-2 my-3"><td class="nav-item <%= 'active' if current_page?(root_path) %> "><%= link_to "« Retour au planning", root_path, class:"text-warning text-decoration-none" %></td></h5>
        <% end %>
      </div>
      <button class="side-btn btn btn-outline-warning mr-3" id="nav-collapse" style="z-index: 9999;"><i class="fas fa-bars"></i></button>
    </nav>
    
    <% if current_user%>
      <% if current_user.incomplete_profile? %>
        <div class="alert alert-warning" role="alert">
         Veuillez remplir vos informations en <b><%= link_to "cliquant ici", user_path(current_user.id), class:"text-warning"%></b> pour profiter pleinement de nos fonctionnalités.  
        </div>
      <% end %>
    <%end%>
    <%= yield %>

    <% if current_page?(root_path) %>
    <footer class="page-footer mt-5">
        <div class="container-fluid bg-success py-1 text-center">
    <% else %>
    <footer class="page-footer fixed-bottom mt-5">
        <div class="container-fluid bg-success py-1 text-center fixed-bottem">
    <% end %>
          <p class="text-white mt-2">
            <i class="far fa-copyright"></i> Fait avec <i class="fas fa-heart text-warning"></i> par l'équipage Nantais 
        </div>  
        <div class="container-fluid bg-dark py-1">
          <div class="container text-center text-white">
          </div>
        </div>
    </footer>
    
    </div>

    <!-- Sidebar-->
    <div id="side-nav" class="container-right" style="display:none;">
      <div class="right-nav bg-light d-flex flex-column ">
        <h1 class="text-warning text-center mt-3 mb-2">Nutriti</h1>
        <hr>
        <tr class="nav flex-column align-items-start right-nav mt-4 ml-4">
          <% if current_user.is_admin %>
            <td class="nav-item align-self-center mr-4 mb-4">
              <%= link_to "Dashboard Admin", admin_dashboard_index_path, class:"btn btn-warning" %>
            </td>   
          <% end %>
          <% unless current_page?(root_path) || current_page?(week_path) %>          
            <h5 class="ml-2 my-3"><td class="nav-item <%= 'active' if current_page?(root_path) %> "><%= link_to "« Retour au planning", root_path, class:"text-warning text-decoration-none" %></td></h5>
          <% end %>
          <h5 class="ml-2 my-3"><td class="nav-item <%= 'active' if current_page?(user_path) %> "><%= link_to "Voir profil", user_path(current_user.id), class: "text-warning text-decoration-none" %></td></h5>
    
          <h5 class="ml-2 my-3"><td class="nav-item"><%= link_to "Editer son petit déjeuner", edit_breakfast_path(current_user.breakfast.id), "data-target" => "#breakfastModal", "data-toggle" =>"modal", remote: true,class:'text-warning text-decoration-none'%></td></h5>
          
          <h5 class="ml-2 my-3"><td class="nav-item"><%= link_to "Générer un repas", meals_path, data:{method: 'post'}, class:'text-warning text-decoration-none'%></td></h5>
    
          <h5 class="ml-2 my-3 mb-5"><td class="nav-item"><%= link_to "Générer une journée", days_path, data:{method: 'post'}, class:'text-warning text-decoration-none'%></td></h5>
    
          <td class="nav-item <%= 'active' if current_page?(root_path) %> align-self-center mr-4 mt-5"><%= link_to "Se déconnecter", destroy_user_session_path, class:"btn btn-danger", method: :delete %></td>
        </tr>
      </div>      
	  </div>
    <!-- End of Sidebar-->
        </div>      
	</div>

  <div class="modal fade " id="breakfastModal" tabindex="-1" role="dialog" aria-labelledby="breakfastModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="breakfastBody">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
      </div>
    </div>
  </div>
</div>

  <script>
let nav = document.getElementById("side-nav");
let content = document.getElementById("content"); 
let button = document.getElementById("nav-collapse");

button.addEventListener("click", function () {
    if (nav.style.display === "none") {
    nav.style.display = "block";
    button.animate([
      { transform: 'translateX(0px)' }, 
      { transform: 'translateX(-250px)' }
    ], { 
      duration: 250,
    });
    nav.animate([
      { transform: 'translateX(+250px)' }, 
      { transform: 'translateX(0px)' }
    ], { 
      duration: 250,
    });
    button.style.transform = "translateX(-250px)";
    button.classList.remove('btn-outline-warning');
    button.classList.add('btn-warning');
  } else {
        button.animate([
      { transform: 'translateX(-250px)' }, 
      { transform: 'translateX(0px)' }
    ], { 
      duration: 250,
    });
    nav.animate([
      { transform: 'translateX(0px)' }, 
      { transform: 'translateX(+250px)' }
    ], { 
      duration: 300,
    });
    button.style.transform = "translateX(0px)";
    button.classList.remove('btn-warning');
    button.classList.add('btn-outline-warning');
    setTimeout(hide, 300)
    function hide() {
      nav.style.display = "none";
    }
  }
})
</script>
  </body>
</html>

